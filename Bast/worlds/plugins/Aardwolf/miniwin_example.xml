<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE muclient>
<!-- $Id$ -->

<muclient>
<plugin
   name="miniwin_example"
   author="Bast"
   id="eee7adec415c1bbb534ef093"
   language="Lua"
   purpose="test miniwin functionality"
   save_state="y"
   date_written="2009-02-13 09:28:14"
   requires="4.37"
   version="2.0"
   >
</plugin>

<!--  Get our standard constants -->

<include name="constants.lua"/>

<script>
<![CDATA[

require 'var'
require 'pluginhelper'
require "miniwin"
require "tprint"
require "commas"
require "serialize"
require "copytable"


testwin = Miniwin:new{name="Example"}
testwin:set_default('header_height', 1)
testwin2 = Miniwin:new{name="Example_2"}
testwin2:set_default('header_height', 1)
testwin2:set_default('use_tabwin', false)
styles = {}
styles2 = {}

-- Header Line, centered
style = {}
style.text = "Example Header"
style.hjust = 'center'
style.font_size = 9
tstyle = {style}
table.insert(styles, tstyle)

-- First Line
style = {}
style.text = " New Test Text p Line 1 @yNew Test Text Line 1@x @CNew Test Text Line 1@x New Test Text Line 1 "
style.hjust = 'center'
style.cellborder = true
style.bordercolour = 'green'
style.hint = serialize.save_simple(style)
style.mouseover = nofunc
nstyle = {style}
--nstyle.backcolour = 'red'
table.insert(styles, nstyle)

-- Second Line, several styles
tstyle = {}

-- Very Large Text
style = {}
style.text = " Large "
style.font_name = 'Courier New'
style.font_size = 30
style.backcolour = "blue"
style.leftborder = true
style.rightborder = true
style.topborder = true
style.bottomborder = true
style.borderstyle = 1
style.hint = serialize.save_simple(style)
style.mouseover = nofunc
table.insert(tstyle, style)

-- Space
style = {}
style.text = " "
style.font_name = 'Courier New'
style.font_size = 8
style.hint = serialize.save_simple(style)
style.mouseover = nofunc
table.insert(tstyle, style)

-- Some text
style = {}
style.text = " Just Text "
style.leftborder = true
style.rightborder = true
style.topborder = true
style.bottomborder = true
style.bordercolour = "yellow"
style.borderwidth = 2
style.hint = serialize.save_simple(style)
style.mouseover = nofunc
table.insert(tstyle, style)

-- Justify Bottom Vertically with hyperlink
style = {}
style.text = " Bottom Vertically (Bold) "
style.vjust = 'bottom'
style.bold = true
style.cellborder = true
style.hint = serialize.save_simple(style)
style.mouseover = nofunc
table.insert(tstyle, style)

-- Justify larger text, Arial Font, red text, green background
style = {}
style.text = " Center Vertically "
style.font_name = 'Arial'
style.font_size = 15
style.backcolour = "green"
style.textcolour = "red"
style.vjust = 'center'
style.hint = serialize.save_simple(style)
style.mouseover = nofunc
table.insert(tstyle, style)

-- Fillall
style = {}
style.text = " FA "
style.font_name = 'Arial'
style.font_size = 15
style.backcolour = "cyan"
style.textcolour = "red"
style.vjust = 'center'
style.fillall = true
style.hint = serialize.save_simple(style)
style.mouseover = nofunc
table.insert(tstyle, style)

-- insert the second line
table.insert(styles, tstyle)

-- New Line
style = {}
style.text = "Just a New Line (Strikeout)"
style.strikeout = true
style.hint = serialize.save_simple(style)
style.mouseover = nofunc
table.insert(styles, {style})

-- New Line, Center Horizontally
style = {}
style.text = "Center Horizontally (Underline)"
style.hjust = 'center'
style.underline = true
style.hint = serialize.save_simple(style)
style.mouseover = nofunc
table.insert(styles, {style})

-- New Line, Right Justify Horizontally
style = {}
style.text = "Right Horizontally (Italic)"
style.italic = true
style.hjust = 'right'
style.hint = serialize.save_simple(style)
style.mouseover = nofunc

table.insert(styles, {style})
styles2 = copytable.deep(styles)


style = {popup_style(testwin2, "Show Miniwin Example 2", "blue")}
style[1].hjust='center'
--style.leftborder = true
--style.rightborder = true
--style.topborder = true
--style.bottomborder = true
style.cellborder = true
style.bordercolour = 'blue'
style.backcolour = 'white'

table.insert(styles, style)
]]>
</script>

<script>
<![CDATA[

function OnPluginBroadcast (msg, id, name, text)
  phelper:OnPluginBroadcast(msg, id, name, text)
end

function OnPluginInstall ()
  --OnPluginEnable is automatically called by pluginhelper

  phelper:OnPluginInstall()
end -- OnPluginInstall

function OnPluginClose ()
  --OnPluginDisable is automatically called by pluginhelper

  phelper:OnPluginClose()
end -- OnPluginClose

function OnPluginEnable ()


  phelper:OnPluginEnable()
  -- always create windows after OnPluginEnable due to default variable handling
  testwin:enable()
  testwin:createwin(styles)
  testwin2:enable()
  testwin2:createwin(styles2)
end -- OnPluginEnable

function OnPluginDisable ()

  phelper:OnPluginDisable()
end -- OnPluginDisable

function OnPluginConnect ()

  phelper:OnPluginConnect()
end -- function OnPluginConnect

function OnPluginDisconnect ()

  phelper:OnPluginDisconnect()
end -- function OnPluginConnect

function OnPluginSaveState ()

  phelper:OnPluginSaveState()
end -- function OnPluginSaveState

]]>
</script>

<script>
<![CDATA[

phelper:set_default('cmd', 'mnexam')
phelper:set_default('plugin_colour', 'steelblue')

phelper:add_pobject('win', testwin)
phelper:add_pobject('win2', testwin2)

phelper:enable()

]]>
</script>
</muclient>
